# Бот для VK

Для работы бота надо составить карту сообщений в папке messages
Где файл 0.json является стартом бота
Бот отправляет стартовое сообщение на любое сообщение ему, для которого он не может найти подходящий файл

Каждый файл json означает новое сообщение. 
Название файла состоит из кодов предыдущих сообщений прописанных через подчёркивание
Коды берутся из кнопок

## Структура файла.
Если нужно одно сообщение в ответ, вы можете разместить объект "Сообщение" прямо в файл
Если нужно несколько сообщений, тогда нужно в файле разместить массив Сообщений

### Массив сообщений 
Ключ для массива "messages"
Пример использования находится в файле messages_massive.json

### Объект Сообщение
Текст видимый пользователю размещается в ключе "text"
Кнопки присоединенные к сообщению должны распологаться в массиве "buttons"
Различные вложения распологаются в массиве "attachments"

#### Кнопки
Текст кнопки распологается в ключе "text"
Цвет кнопки распологается в ключе "color" (опционально, в случае если не указано, будет default). Цвета идут в соответствии с vkApi
Код из которого бот поймёт какой следующий файл взять размещается в поле "code"
Коды START и BACK отправляют пользователя соответственно в самый старт скрипта либо на шаг назад

#### Вложения 
Вложения уже должны быть загружены и должны быть с публичным доступом
Вложения по идее должны работать любые поддерживаемые VK но тестировали только с картинками
Поле type для обозначения типа вложения. Возможные варианты: photo/doc/audio
В поле value размещается "id владельца вложения"_"id вложения"
Взять это можно например, из ссылки на объект 
Например если ссылка на вашу картинку https://vk.com/superandroiddeveloper?z=photo3433138_456239958%2Falbum3433138_00
тогда 3433138_456239958 должно расположиться в поле value


### Основа логики взята из тестового образца бота:

Пример простого бота для ВКонтакте на PHP. Обработка событий с использованием Callback API, голосовые сообщения с помощью Яндекс SpeechKit.

Сообщество бота: https://vk.com/botexample. Бот отправляет в ответ на любое сообщение картинку и голосовое сообщение с именем собеседника.

#### Подготовка к использованию
Укажите свои данные в [config.php](https://github.com/VKCOM/bot-example-php/blob/master/www/config.php).
Ключ доступа к API и код подтверждения для Callback API Вы можете получить в настройках сообщества. Подробнее о получении ключа доступа для Яндекс SpeechKit можно прочитать [здесь](https://tech.yandex.ru/speechkit/).

##### Описание файлов
###### [index.php](https://github.com/VKCOM/bot-example-php/blob/master/www/index.php)
Обработка событий Callback API. В нашем примере обрабатываются два события:
- *confirmation* — уведомление для подтверждения адреса сервера;
- *new_message* — уведомление о входящем сообщении. 

Подробную информацию о типах событий и формате уведомлений Вы найдёте [в документации ВК API](https://vk.com/dev/callback_api). 

###### [bot/bot.php](https://github.com/VKCOM/bot-example-php/blob/master/www/bot/bot.php)
Отправка сообщений с вложениями. 

###### [api/vk_api.php](https://github.com/VKCOM/bot-example-php/blob/master/www/api/vk_api.php)
Функции для работы с методами API ВКонтакте

###### [api/yandex_api.php](https://github.com/VKCOM/bot-example-php/blob/master/www/api/yandex_api.php)
Функции для работы с API Яндекс SpeechKit для генерация голосовых сообщений.
